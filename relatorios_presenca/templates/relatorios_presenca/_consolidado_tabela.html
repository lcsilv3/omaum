<!-- relatorios_presenca/_consolidado_tabela.html -->

<div id="relatorio-tabela-container">
    {% if dados.alunos %}
    <table class="table table-striped table-bordered mt-4">
        <thead>
            <tr>
                <th>Aluno</th>
                <th>Total Presenças</th>
                <th>Total Faltas</th>
                <th>Total Justificadas</th>
                <th>% Presença</th>
            </tr>
        </thead>
        <tbody>
            {% for aluno_dados in dados.alunos %}
            <tr>
                <td>{{ aluno_dados.aluno.nome }}</td>
                <td>{{ aluno_dados.totais.P|default:0 }}</td>
                <td>{{ aluno_dados.totais.F|default:0 }}</td>
                <td>{{ aluno_dados.totais.J|default:0 }}</td>
                <td>
                    {% with total_atividades=aluno_dados.totais.P|default:0|add:aluno_dados.totais.F|default:0|add:aluno_dados.totais.J|default:0 %}
                        {% if total_atividades > 0 %}
                            {% with percentual=(aluno_dados.totais.P|default:0|div:total_atividades)*100 %}
                                {{ percentual|floatformat:2 }}%
                            {% endwith %}
                        {% else %}
                            0.00%
                        {% endif %}
                    {% endwith %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="mt-4">Nenhum dado encontrado para os filtros selecionados.</p>
    {% endif %}
</div>
