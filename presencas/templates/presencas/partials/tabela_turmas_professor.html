<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Turma</th>
                <th>Disciplina</th>
                <th>Total Alunos</th>
                <th>Presença Média</th>
                <th>Aprovação</th>
                <th>Carências</th>
                <th>Status</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for turma in dados_turmas %}
            <tr>
                <td>
                    <strong>{{ turma.turma__nome|default:"Não informado" }}</strong>
                    <br><small class="text-muted">{{ turma.turma__codigo|default:"" }}</small>
                </td>
                <td>{{ turma.disciplina|default:"Não informada" }}</td>
                <td>
                    <span class="badge bg-info">{{ turma.total_alunos|default:0 }}</span>
                </td>
                <td>
                    <div class="progress" style="height: 20px;">
                        <div class="progress-bar {% if turma.presenca_media >= 80 %}bg-success{% elif turma.presenca_media >= 60 %}bg-warning{% else %}bg-danger{% endif %}" 
                             role="progressbar" 
                             style="width: {{ turma.presenca_media|default:0 }}%;"
                             aria-valuenow="{{ turma.presenca_media|default:0 }}" 
                             aria-valuemin="0" 
                             aria-valuemax="100">
                            {{ turma.presenca_media|default:0 }}%
                        </div>
                    </div>
                </td>
                <td>
                    <span class="badge {% if turma.percentual_aprovacao >= 80 %}bg-success{% elif turma.percentual_aprovacao >= 60 %}bg-warning{% else %}bg-danger{% endif %}">
                        {{ turma.percentual_aprovacao|default:0 }}%
                    </span>
                </td>
                <td>
                    {% if turma.total_carencias > 0 %}
                        <span class="badge bg-danger">{{ turma.total_carencias }}</span>
                    {% else %}
                        <span class="badge bg-success">0</span>
                    {% endif %}
                </td>
                <td>
                    {% if turma.presenca_media >= 80 %}
                        <span class="badge bg-success">
                            <i class="fas fa-check"></i> Ótimo
                        </span>
                    {% elif turma.presenca_media >= 60 %}
                        <span class="badge bg-warning text-dark">
                            <i class="fas fa-exclamation"></i> Atenção
                        </span>
                    {% else %}
                        <span class="badge bg-danger">
                            <i class="fas fa-exclamation-triangle"></i> Crítico
                        </span>
                    {% endif %}
                </td>
                <td>
                    <div class="btn-group btn-group-sm" role="group">
                        <button type="button" class="btn btn-outline-primary" title="Ver detalhes">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button type="button" class="btn btn-outline-info" title="Relatório">
                            <i class="fas fa-chart-bar"></i>
                        </button>
                        {% if turma.presenca_media < 60 %}
                        <button type="button" class="btn btn-outline-warning" title="Plano de ação">
                            <i class="fas fa-clipboard-list"></i>
                        </button>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" class="text-center text-muted">
                    <i class="fas fa-info-circle"></i> Nenhuma turma encontrada para este professor.
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if dados_turmas %}
<div class="row mt-3">
    <div class="col-md-4">
        <div class="card border-success">
            <div class="card-body text-center">
                <h6 class="text-success">Turmas Ótimas</h6>
                <h4>{{ total_turmas_otimas|default:0 }}</h4>
                <small class="text-muted">≥ 80% presença</small>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card border-warning">
            <div class="card-body text-center">
                <h6 class="text-warning">Turmas Atenção</h6>
                <h4>{{ total_turmas_atencao|default:0 }}</h4>
                <small class="text-muted">60-79% presença</small>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card border-danger">
            <div class="card-body text-center">
                <h6 class="text-danger">Turmas Críticas</h6>
                <h4>{{ total_turmas_criticas|default:0 }}</h4>
                <small class="text-muted">< 60% presença</small>
            </div>
        </div>
    </div>
</div>
{% endif %}
